{
  "version": 3,
  "sources": ["../src/classes/Observable.js", "../src/classes/View.js", "../src/loop.js", "../src/time.js", "../src/player.js", "../src/logger.js", "../src/window.js", "../src/keyboard.js", "../src/classes/Destroyable.js", "../src/classes/Renderable.js", "../src/factories/createMessage.js", "../src/sendMessageToPlayer.js", "../src/game.js", "../src/main.js"],
  "sourcesContent": ["export class Observable {\n  constructor() {\n    const observersByKey = {}\n\n    this.observe = (key, fn) => {\n      if (!observersByKey[key]) observersByKey[key] = []\n      observersByKey[key].push(fn)\n    }\n\n    this.unobserve = (key, fn) => {\n      if (!observersByKey[key]) observersByKey[key] = []\n      observersByKey[key] = observersByKey[key].filter(f => f !== fn)\n    }\n\n    this.getObservers = (key) => {\n      return observersByKey[key] || []\n    }\n  }\n\n  notify(key, message) {\n    const observers = this.getObservers(key)\n\n    for (let index = 0; index < observers.length; index++) {\n      const observer = observers[index];\n      observer(message)\n    }\n  }\n}\n", "export class View {\n  constructor() {\n    const root = document.createElement('div')\n\n    this.get = () => root\n    this.set = (node) => {\n      this.clear()\n      this.append(node)\n    }\n    this.clear = () => root.innerHTML = ''\n    this.append = (node) => root.append(node)\n  }\n}\n", "import { Observable } from \"./classes/Observable\"\nimport { View } from \"./classes/View\"\n\nclass Loop extends Observable {\n  constructor() {\n    super()\n    const self = this\n    const view = new View()\n    const content = document.createElement('div')\n\n    let frame = 0\n    let shouldRun = false\n\n    content.innerHTML = `frame: ${frame}`\n    view.set(content)\n\n    function loop() {\n      frame++\n      self.notify('frame', frame)\n      content.innerHTML = `[loop.js] frame: ${frame}`\n\n      if (shouldRun) requestAnimationFrame(loop)\n    }\n\n    this.start = () => {\n      if (shouldRun) return\n      shouldRun = true\n      requestAnimationFrame(loop)\n    }\n\n    this.stop = () => shouldRun = false\n\n    this.get = view.get\n  }\n}\n\nconst loop = new Loop()\n\nexport default loop", "import { View } from \"./classes/View\"\n\nclass Time {\n  constructor() {\n    const view = new View()\n    const content = document.createElement('div')\n\n    content.innerHTML = new Date().toString()\n    setInterval(() => {\n      content.innerHTML = new Date().toString()\n    }, 1000)\n\n    view.set(content)\n\n    this.get = view.get\n  }\n}\n\nconst time = new Time()\n\nexport default time", "import { View } from \"./classes/View\"\n\nclass Player {\n  constructor() {\n    const view = new View()\n\n    const content = document.createElement('div')\n    content.innerHTML = 'hello from player'\n    view.set(content)\n\n    this.get = view.get\n  }\n}\n\nconst player = new Player()\n\nexport default player", "import { View } from \"./classes/View\"\n\nclass Logger {\n  constructor() {\n    const view = new View()\n    const root = document.createElement('div')\n    const head = document.createElement('div')\n    const body = document.createElement('div')\n\n    const logs = []\n\n    setUI()\n\n    function setUI() {\n      head.innerHTML = 'logger head'\n\n      const toggleButton = document.createElement('button')\n      toggleButton.onclick = () => {\n        body.style.display = body.style.display === 'none' ? 'block' : 'none'\n      }\n      toggleButton.innerText = 'toggle logger visibility'\n      head.append(toggleButton)\n\n      body.innerHTML = 'logger body'\n\n      root.style.border = '1px solid'\n      root.style.maxHeight = '200px'\n      root.style.overflowY = 'auto'\n\n      root.append(head)\n      root.append(body)\n      view.set(root)\n    }\n\n    this.log = (message) => {\n      logs.push(message)\n      this.render()\n    }\n\n    this.render = () => {\n      body.innerHTML = ''\n      for (let index = logs.length-1; index >= 0; index--) {\n        const log = logs[index];\n        body.innerHTML += log + '<br>'\n      }\n    }\n\n    this.get = view.get\n  }\n}\n\nconst logger = new Logger()\n\nexport default logger", "import { View } from \"./classes/View\"\n\nclass WindowEventProxy {\n  view = new View()\n  eventListener = {}\n\n  constructor() {\n    const dom = this.view.get()\n    dom.style.border = '1px solid'\n    dom.style.padding = '1rem'\n  }\n\n  addEventListener(eventKey, key, func) {\n    // set default value\n    if (!this.eventListener[eventKey]) this.eventListener[eventKey] = {}\n\n    // save listener\n    this.eventListener[eventKey][key] = func\n\n    // add listener to real window\n    window.addEventListener(eventKey, func)\n\n    this.update()\n  }\n\n  removeEventListener(eventKey, key) {\n    // remove listener from real window first\n    window.removeEventListener(eventKey, this.eventListener[eventKey][key])\n\n    // remove listener\n    delete this.eventListener[eventKey][key]\n\n    this.update()\n  }\n\n  update() {\n    const listeners = []\n    Object.keys(this.eventListener).forEach(eventKey => {\n      Object.keys(this.eventListener[eventKey]).forEach(key => {\n        listeners.push(eventKey + '/' + key)\n      })\n    })\n\n    const contentRoot = document.createElement('pre')\n    const content = document.createElement('code')\n    contentRoot.append(content)\n    content.innerHTML = JSON.stringify(listeners, [' '], 2)\n\n    this.view.set(contentRoot)\n  }\n\n  get() {\n    return this.view.get()\n  }\n}\n\nconst windowEventProxy = new WindowEventProxy()\nexport default windowEventProxy\n", "import windowEventProxy from \"./window\"\n\nconst keyboard = {\n  on: (event, callback) => {\n    windowEventProxy.addEventListener(event, 'keyboard', callback)\n  },\n  addNamedListener: (event, name, callback) => {\n    windowEventProxy.addEventListener(event, `keyboard_${name}`, callback)\n  },\n  removeNamedListener: (event, name) => {\n    windowEventProxy.removeEventListener(event, `keyboard_${name}`)\n  }\n}\n\nexport default keyboard", "export class Destroyable {\n  constructor(DOM) {\n    this.destroy = () => DOM.remove()\n  }\n}\n", "const TARGET = document.body\n\nexport class Renderable {\n  constructor(DOM) {\n    this.render = () => TARGET.append(DOM)\n  }\n}\n", "import { Destroyable } from \"../classes/Destroyable\"\nimport { Renderable } from \"../classes/Renderable\"\n\nconst ELEMENT = 'p'\n\nexport function createMessage(message) {\n  const dom = document.createElement(ELEMENT)\n  dom.innerHTML = message\n  return Object.assign({}, new Destroyable(dom), new Renderable(dom))\n}\n", "import { createMessage } from \"./factories/createMessage\";\nimport keyboard from \"./keyboard\"\n\nconst NAME = 'sendMessageToPlayer'\n\n/**\n * @param {string} message message for player\n * @param {string} dismisser keyboard key to dismiss the message\n * @param {Function} callback function to be called after the message dismissed\n */\nexport default function sendMessageToPlayer(message, dismisser, callback) {\n  const _message = createMessage(message)\n\n  _message.render()\n\n  keyboard.addNamedListener('keypress', NAME, e => {\n    if (e.key !== dismisser) return\n\n    _message.destroy()\n    keyboard.removeNamedListener('keypress', NAME)\n    callback()\n  })\n}\n", "import loop from \"./loop\"\nimport time from \"./time\"\nimport player from \"./player\"\nimport logger from \"./logger\"\nimport keyboard from \"./keyboard\"\nimport { View } from \"./classes/View\"\nimport sendMessageToPlayer from \"./sendMessageToPlayer\"\n\nclass Game {\n  constructor() {\n    let isStarted = false;\n    const view = new View()\n\n    sendMessageToPlayer('press \"f\" to start the machine', 'f', () => this.start());\n\n    this.start = () => {\n      sendMessageToPlayer('Welcome!<br>press \"l\" to start the logger', 'l', () => {\n        view.append(logger.get())\n\n        const content = document.createElement('div')\n        const frameDisplay = document.createElement('div')\n        content.append(frameDisplay)\n        view.append(content)\n\n        /* set player input system */\n        keyboard.on('keypress', e => {\n          if (e.key === 'a') loop.start()\n          if (e.key === 's') loop.stop()\n          if (e.key === 't') content.append(time.get())\n          if (e.key === 'p') content.append(player.get())\n          if (e.key === 'l') content.append(loop.get())\n        })\n\n        logger.log(`\n          press one of these keys:\n            <br>\"a\" to start loop engine, \"s\" to stop it.\n            <br>\"t\" to append time\n            <br>\"p\" to append player\n            <br>\"l\" to append loop\n        `)\n\n        /* set process system */\n        loop.observe('frame', (frame) => {\n          frameDisplay.innerText = `[game.js] frame: ${frame}`\n        })\n      });\n\n      isStarted = true\n    }\n\n    this.get = view.get\n  }\n}\n\nconst game = new Game()\nexport default game", "import game from './game'\n\ndocument.body.append(game.get())\n"],
  "mappings": "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",
  "names": ["loop"]
}
